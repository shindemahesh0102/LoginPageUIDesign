import{_ as I,aJ as w,r as v,o as l,c as r,g as m,f as k,a as L,b as d,F as A,z as D,n as g,t as p,A as b,e as C}from"./bootstrap-5b74a21d.mjs";import{a as P,u as T}from"./usePrimaryImageDimensions-8af5ead8.mjs";import{u as z}from"./useWindowDimensions-da63f265.mjs";const F={props:{imagePosition:{type:String,default:"none"},imageShaping:{type:String,default:"crop"},item:{type:Object,required:!0},showSummary:{type:Boolean,default:!0},showDate:{type:Boolean,default:!0},displayFullHeadline:{type:Boolean,default:!1},titleFontSize:{type:Number,default:16},itemMask:{type:Boolean,default:!1},pageCompanyName:{type:String},percentOfContentArea:{type:Number},lazyLoadImage:{type:Boolean,default:!0}},data(){return{lockType:null,bibblioTracked:!1}},computed:{useApStylePubDate(){return w},hasPrimarySection(){var e;return!!((e=this.item.primarySection)==null?void 0:e.alias)},nameAndAlias(){var e,a,t,n,s;if(this.showCompanyDate){const i=(t=(e=this.item.company)==null?void 0:e.name)!=null?t:(a=this.firstAuthor)==null?void 0:a.name,o=i===((n=this.item.company)==null?void 0:n.name)?this.companyLink:(s=this.firstAuthor)==null?void 0:s.path;return{name:i,alias:o}}return{}},imageAlt(){var e,a,t,n,s,i,o;return(o=(s=(a=(e=this==null?void 0:this.item)==null?void 0:e.primaryImage)==null?void 0:a.displayName)!=null?s:(n=(t=this==null?void 0:this.item)==null?void 0:t.primaryImage)==null?void 0:n.alt)!=null?o:((i=this.item)==null?void 0:i.nativeImagePath)?this.item.nativeTitle:""},imageDimensions(){return P(this.imagePosition,this.percentOfContentArea,1.8,this.$ss.contentStyle.smallImageWidth,this.$ss.contentStyle.smallImageHeight)},imageUrl(){var y,h;if(this.item.nativeImagePath)return this.item.nativeImagePath;const{src:e,isLogo:a}=(h=(y=this.item)==null?void 0:y.primaryImage)!=null?h:{};if(!e)return"";const t=`${e.split("?")[0]}?auto=format,compress`,n=`&fit=${a?"fill&pad=5":this.imageShaping}`,s=this.imageShaping==="fill"||a?"&fill-color=white":"",i=T(this.imagePosition,null,this.percentOfContentArea,this.$ss.contentStyle.smallImageWidth,this.$ss.contentStyle.smallImageHeight),o=`&h=${Math.round(i.height)}`,c=`&w=${Math.round(i.width)}`;return`${t}${n}${s}${o}${c}&q=45`},primarySectionAlias(){var a,t,n,s;const e=(t=(a=this.item)==null?void 0:a.primarySection)==null?void 0:t.alias;return(!e.startsWith("http")&&!e.startsWith("/")?"/":"")+((s=(n=this.item)==null?void 0:n.primarySection)==null?void 0:s.alias)},firstAuthor(){var e,a,t;return(t=(a=(e=this.item)==null?void 0:e.authors)==null?void 0:a.edges[0])==null?void 0:t.node},firstContributor(){var e,a,t;return(t=(a=(e=this.item)==null?void 0:e.contributors)==null?void 0:a.edges[0])==null?void 0:t.node},title(){var e,a;return(a=(e=this.item.nativeTitle)!=null?e:this.item.shortName)!=null?a:this.item.name},summary(){var e;return(e=this.item.nativeSummary)!=null?e:this.item.teaser},itemUrl(){var e,a,t,n,s,i,o,c;return(c=(o=(i=(n=(e=this.item)==null?void 0:e.nativeUrl)!=null?n:(t=(a=this.item)==null?void 0:a.siteContext)==null?void 0:t.path)!=null?i:(s=this.item)==null?void 0:s.alias)!=null?o:`/${this.item.objectID}`)!=null?c:""},companyLink(){return this.item.company?`/${this.item.company.id}`:""},showCompanyDate(){var e;return((e=this.item.company)==null?void 0:e.name)!==this.pageCompanyName&&this.$ss.contentStyle.showCompanyDate},getImagePosition(){return this.imagePosition||"none"}},async mounted(){var a,t,n,s,i,o,c,f;const e=(a=this.$ss.loginRegistration)==null?void 0:a.showTitleLocks;if(e){const y=(n=(t=await this.$idx.getContext())==null?void 0:t.mergedAccessLevels)!=null?n:[],h=(o=(i=(s=this.item)==null?void 0:s.userRegistration)==null?void 0:i.accessLevels)!=null?o:[];let S=((f=(c=this.item)==null?void 0:c.userRegistration)==null?void 0:f.isRequired)&&!this.$idx.isLoggedIn();h.length&&(h.forEach(u=>{y.find(_=>_.id===u)&&(S=!1)}),this.lockType=e?S?"lock":"unlock":null)}this.item.type==="external_bibblio"&&(window.addEventListener("scroll",this.handleScroll),this.handleScroll())},unmounted(){window.removeEventListener("scroll",this.handleScroll)},methods:{handleScroll(){this.bibblioTracked||this.$refs.item.getBoundingClientRect().top-z().value.headerHeight<=300&&(this.trackBibblioEvent("Viewed"),this.bibblioTracked=!0)},trackBibblioEvent(e){var a;if(this.item.type==="external_bibblio"){const t={type:e,sourceHref:`${window.location.protocol}//${window.location.host}${this.$route.fullPath}`,trackingInfo:(a=this.item)==null?void 0:a.trackingInfo};this.$gql.mutate("setBibblioEvent",t)}}}},x={key:0,class:"mask"},W={key:2,class:"image-wrapper"},B={class:b(["text-box"])},H={key:0},U=["href","target"],E=["href","target","rel"],M=["innerHTML"],N={key:0,class:"name"},q=["href"],j={key:1,class:"date"},O=["innerHTML"];function R(e,a,t,n,s,i){var y,h,S;const o=v("LazyWebImgLazyLoader"),c=v("LazyWebImage"),f=C;return l(),r("div",{ref:"item",class:b(["ebm-content-item",i.getImagePosition!=="none"&&i.imageUrl?"image-"+i.getImagePosition:"","section-"+e.$ss.contentStyle.sectionLocation]),style:g({display:i.getImagePosition==="above"||i.getImagePosition==="behind"?"block":"flex",flexDirection:i.getImagePosition==="right"?"row-reverse":"row"})},[t.itemMask?(l(),r("div",x)):m("",!0),t.item.nativeImpressionTrackerUrl?(l(),k(o,{key:1,href:t.item.nativeImpressionTrackerUrl},null,8,["href"])):m("",!0),i.getImagePosition!=="none"&&i.imageUrl?(l(),r("div",W,[L(c,{width:i.imageDimensions.width,height:i.imageDimensions.height,image:i.imageUrl,"is-logo":t.item.primaryImage?t.item.primaryImage.isLogo:!1,"image-shaping":t.imageShaping,alt:i.imageAlt,credit:t.item.primaryImage?t.item.primaryImage.credit:"","credit-position":"top","content-type":t.item.contentType||t.item.type,"image-link":i.itemUrl,"lazy-load":t.lazyLoadImage},null,8,["width","height","image","is-logo","image-shaping","alt","credit","content-type","image-link","lazy-load"])])):m("",!0),d("div",B,[(l(!0),r(A,null,D(t.item.labels,u=>(l(),r("div",{key:u,class:"sponsored",style:g({color:e.$ss.contentStyle.sponsoredTextColor,fontFamily:e.$ss.primaryFontFamily})},[u==="Sponsored"||u==="Members Only"||u==="Supported"?(l(),r("span",H,p(u)+" Content",1)):m("",!0)],4))),128)),d("div",{style:g({display:"flex",flexDirection:e.$ss.contentStyle.sectionLocation==="top"?"column":"column-reverse"})},[i.hasPrimarySection&&e.$ss.contentStyle.sectionLocation!=="none"?(l(),r("a",{key:0,class:"section-name",href:i.primarySectionAlias,target:i.primarySectionAlias.startsWith("http")?"_blank":"_self",style:g({fontFamily:e.$ss.primaryFontFamily,color:e.$ss.contentStyle.sectionColor})},p(t.item.primarySection.name),13,U)):m("",!0),d("div",null,[d("a",{href:i.itemUrl,target:i.itemUrl.startsWith(`https://www.${e.$ss.general.rootDomain}`)||i.itemUrl.startsWith("/")?"_self":"_blank",class:"title-wrapper",rel:((h=(y=t.item)==null?void 0:y.labels)==null?void 0:h.includes("Sponsored"))?"sponsored":null,onClick:a[0]||(a[0]=()=>{i.trackBibblioEvent("Clicked")})},[d("h3",{class:b(["title-text",[t.displayFullHeadline?"":"clamp-headline"]]),style:g([t.displayFullHeadline?{fontSize:t.titleFontSize+"px",lineHeight:t.titleFontSize*1.3+"px"}:{fontSize:t.titleFontSize+"px",maxHeight:t.titleFontSize*3+16+"px"}])},[s.lockType?(l(),k(f,{key:0,icon:`noto:${s.lockType}ed`,class:"lock","icon-color":"gold",width:18},null,8,["icon"])):m("",!0),d("div",{innerHTML:i.title},null,8,M)],6)],8,E),d("div",{style:g({display:"flex",flexDirection:e.$ss.contentStyle.dateLocation==="above_summary"?"column":"column-reverse"})},[i.useApStylePubDate(t.item)&&t.showDate&&e.$ss.contentStyle.dateLocation!=="none"?(l(),r("div",{key:0,class:"name-and-date",style:g({color:e.$ss.contentStyle.dateTextColor,fontFamily:e.$ss.primaryFontFamily})},[i.nameAndAlias.name?(l(),r("div",N,[d("a",{href:i.nameAndAlias.alias},p(i.nameAndAlias.name),9,q)])):m("",!0),i.useApStylePubDate(t.item)?(l(),r("div",j,p(i.useApStylePubDate(t.item)),1)):m("",!0)],4)):m("",!0),t.showSummary?(l(),r("div",{key:1,class:"teaser-text",innerHTML:(S=i.summary)!=null?S:""},null,8,O)):m("",!0)],4)])],4)])],6)}var K=I(F,[["render",R],["__scopeId","data-v-5e6c0d9b"]]);export{K as default};
